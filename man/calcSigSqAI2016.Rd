% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiMatch.R
\name{calcSigSqAI2016}
\alias{calcSigSqAI2016}
\title{Calculate Variance as in Abadie & Imbens (2016) JASA}
\usage{
calcSigSqAI2016(W, X_covars, Y, N, num_trts, trt_levels, match_mat_AI2016,
  prop_score_ests, vcov_coeff, tau_dfm, ...)
}
\arguments{
\item{W}{A treatment vector (1 x n) with numerical values indicating
treatment groups}

\item{X_covars}{The matrix of covariates (not the matrix of estimated GPS)}

\item{Y}{A response vector (1 x n)}

\item{N}{The total number of units}

\item{num_trts}{The number of unique treatments (3+), a scalar}

\item{trt_levels}{A vector (of length \code{num_trts} providing the unique
treatment levels}

\item{match_mat_AI2016}{Information on matches from
\code{\link{matchAllTreatments}}}

\item{prop_score_ests}{The matrix of propensity scores}

\item{vcov_coeff}{The variance-covariance (inverse fisher information) matrix
from the multinomial logistic regression model}

\item{tau_dfm}{The dataframe of estimates and estimated standard errors
output from \code{\link{estimateTau}}}

\item{...}{the dots argument}
}
\value{
A list with the updated \code{tau_dfm} includeing a column for
  \code{VarianceAI2016}, and a list object \code{AI2016_args} with
  potentially helpful extra information.
}
\description{
This function calculates the estimated variance of matching estimator when
matching on propensity scores that were estimated with multinomial logistic
regression. This method takes into account the uncertainty from the treatment
model. This function does no "heavy lifting" in that it only assembles pieces
that have been estimated elsewhere (i.e., see \code{\link{estSigSq}} to see
how the matching procedures are carried out).
}
\references{
Abadie, A., & Imbens, G. W. (2016). Matching on the estimated
  propensity score. Econometrica, 84(2), 781-807.
  \url{https://doi.org/10.3982/ECTA11293}
}

